You are a senior Flutter engineer refactoring an IoT smart-home app.
Your tasks:

Create a unified layout system for all IoT device screens

Build 3 reusable screen templates:

RoomListScreen → danh sách Phòng

RoomDevicesScreen → danh sách Thiết bị trong Phòng

DeviceDetailScreen → panel điều khiển thiết bị

Apply this unified layout to implement the “Phòng Ngủ” room first:

Rèm cửa

Quạt

Điều hòa

All interface text MUST be in Vietnamese (buttons, titles, labels, states…),
but the explanation + instructions remain in English.

1. Architecture Rules (Do not break)

Keep existing structure. Add new ones:

lib/shared/layout/
    app_scaffold.dart
    device_panel_layout.dart

lib/features/devices/presentation/
    room_list_screen.dart
    room_devices_screen.dart
    device_detail_screen.dart
    panels/
        curtain_panel.dart
        fan_panel.dart
        ac_panel.dart


Use the existing design tokens:

AppColors

AppSpacing

AppTypography

ScreenSizeClass

NO hard-coded numeric paddings, margins, widths, heights, or font sizes.

2. Unified Layout System (must implement)
A. AppScaffold

Reusable scaffold wrapper for all screens:

Optional back button

Title in Vietnamese

Optional action icon

Standardized padding using AppSpacing

Supports responsive spacing via ScreenSizeClass

Scroll behavior unified

B. DevicePanelLayout

A reusable layout for ALL device detail screens:

Header: icon + title in Vietnamese + device state text

Mode selector row

Main control (dial/slider/progress/etc.)

Secondary controls (speed, preset, power…)

Automation block

Agent must generate full code + comments.

3. Required Screen Flow
RoomListScreen
    ↓ Chọn phòng
RoomDevicesScreen
    ↓ Chọn thiết bị
DeviceDetailScreen

A. RoomListScreen (UI text in Vietnamese)

Title: “Phòng”

Each room card shows:

Tên phòng (VD: “Phòng Ngủ”)

Số thiết bị: “1 thiết bị”, “2 thiết bị”, …

B. RoomDevicesScreen

Title: “Thiết bị trong [Tên Phòng]”

Card for each device:

Icon

Name (VD: “Rèm Cửa”, “Quạt”, “Điều hòa”)

Status (VD: “Đang bật”, “Đang tắt”, “Đang mở 40%”)

C. DeviceDetailScreen

Loads one of the panel widgets depending on device type.

Pseudo:

switch (device.type) {
  case DeviceType.curtain: return CurtainPanel(device: device);
  case DeviceType.fan:     return FanPanel(device: device);
  case DeviceType.ac:      return ACPanel(device: device);
}

4. Implement Panels for “Phòng Ngủ” (Vietnamese UI)

Agent MUST use all Vietnamese UI text exactly as below.

PANEL 1 — CurtainPanel (Rèm Cửa)
UI text:

Title: “Rèm Cửa”

States:

“Đang mở X%”

“Đang đóng”

Slider labels: none

Presets:

“Đóng”

“50%”

“Mở hết”

Automation title: “Tự động hóa”

Automation sample rows:

“Mở lúc 7:00”

“Đóng khi trời tối”

Required layout:
[Back]  Rèm Cửa — trạng thái: Đang mở 40%

[Icon rèm có animation]

Slider điều chỉnh mức mở

Nút nhanh:
[Đóng] [50%] [Mở hết]

Tự động hóa:
- Mở lúc 7:00
- Đóng khi trời tối

PANEL 2 — FanPanel (Quạt)
UI text:

Title: “Quạt”

State: “Đang bật” / “Đang tắt”

Speed label: “Tốc độ”

Mode label: “Chế độ”

Modes:

“Tự động”

“Êm”

“Mạnh”

Timer label: “Hẹn giờ”

Timer options:

“Tắt”

“30 phút”

“1 giờ”

“2 giờ”

Power label: “Nguồn”

Required layout:
[Back]  Quạt — Đang bật

[Vòng điều khiển tốc độ 1–3]

Tốc độ:
[1] [2] [3]

Chế độ:
[Tự động] [Êm] [Mạnh]

Hẹn giờ:
[Tắt] [30 phút] [1 giờ] [2 giờ]

Nguồn:
[Switch]

PANEL 3 — ACPanel (Điều hòa)

(Reuse existing design but unify with the new layout)

Required Vietnamese text:

Title: “Điều hòa”

Speed → “Tốc độ”

Power → “Nguồn”

Temp → “Nhiệt độ”

Mode icons → keep, but labels must be Vietnamese:

“Hẹn giờ”

“Làm mát”

“Khử ẩm”

“Sưởi”

Power state:

“Bật”

“Tắt”

5. UI Design System Rules (Strict)

Do NOT write:

SizedBox(height: 20)

TextStyle(fontSize: 18)

EdgeInsets.all(24)

Must use:

AppSpacing
AppTypography
AppColors
ScreenSizeClass breakpoints


Responsive rules:

Small screens → content stacked vertically

Large screens → allow split layout (2 columns)

6. Output Requirements

Agent must output:

Full Dart code for:

AppScaffold

DevicePanelLayout

RoomListScreen

RoomDevicesScreen

DeviceDetailScreen

CurtainPanel

FanPanel

ACPanel (refactored)

Vietnamese UI text exactly as given

Use mock data:

Phòng: “Phòng Ngủ”
Thiết bị:
 - Rèm Cửa (curtain)
 - Quạt (fan)
 - Điều hòa (ac)


Panels MUST visually match the vibe of the existing Điều hòa panel (rounded cards, gradients, spacing system).

END OF PROMPT